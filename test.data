femheart HEART
{
  mesh = Niederer_bm_re0_0.vtk;
  fiber = Niederer_bm_re0_0.fiber;
  sheet = Niederer_bm_re0_0.sheet;
  trans = Niederer_bm_re0_0.transverse;
  //anatomy = Niedererb_re0.anatomy;
   anatomy = Niedererb_re0_1.anatomy;
  //anatomy = an;

  // conductivities
  //sigma_m = 1 1 1;
  sigma_m = 0.133417721518987 0.0176061776061776 0.0176061776061776;
  points = 0 0 0 10 3.5 1.5;

  paraview = 0;
  glvis = 1;
  //icell = 3;

  dt = 0.001 ms;
  reaction = M;

  output_rate = 1 ms;
  Cm = 0.01;

  init_vm = -83.00 mV;

  // 7 stimulus protocol
  //stimulus = lv1 lv2 lv3 lv4 rv1 rv2 rv3;

  // Niederer
  stimulus = lowerLeft;

}


M REACTION {
  method = BetterTT06;
  cellTypes = 1;
}


lowerLeft STIMULUS {
  start=0;
  duration=2;
  strength=35.71429;
  //strength=1000;
  where=lower;
}

lower REGION {
  type = box;
  lower = 0 0 0;
  upper = 1.5 1.5 1.5;
}

M REACTION { fit=M_fit; }
M_fit FIT {
   dt = 0.001;
   celltype = 1;
   g_K1 = 5.405;
   functions = M_interpFunc0__fCass_RLA M_interpFunc1__Xr1_RLA M_interpFunc2__Xr1_RLB M_interpFunc3__Xr2_RLA M_interpFunc4__Xr2_RLB M_interpFunc5__Xs_RLA M_interpFunc6__Xs_RLB M_interpFunc7__d_RLA M_interpFunc8__d_RLB M_interpFunc9__f2_RLA M_interpFunc10__f2_RLB M_interpFunc11__f_RLA M_interpFunc12__f_RLB M_interpFunc13__h_RLA M_interpFunc14__h_RLB M_interpFunc15__j_RLA M_interpFunc16__j_RLB M_interpFunc17__m_RLA M_interpFunc18__m_RLB M_interpFunc19__r_RLA M_interpFunc20__r_RLB M_interpFunc21__s_RLA M_interpFunc22__s_RLB M_interpFunc23_exp_gamma_VFRT M_interpFunc24_exp_gamma_m1_VFRT M_interpFunc25_i_CalTerm3 M_interpFunc26_i_CalTerm4 M_interpFunc27_i_NaK_term M_interpFunc28_i_p_K_term M_interpFunc29_inward_rectifier_potassium_current_i_Kitot ;
}
M_interpFunc0__fCass_RLA FUNCTION { numer=3; denom=3; coeff=-1.219504759094799e-05 6.89464960144461e-14 -0.00487801903577084 -7.43699325013845e-09 9.758477159523247 ; }
M_interpFunc1__Xr1_RLA FUNCTION { numer=9; denom=7; coeff=-5.460153339557624e-06 -3.750254009182817e-07 -1.385640341617651e-08 -3.192856906151162e-10 -5.248408232226164e-12 -6.326689984956573e-14 -6.060802738690719e-16 -4.11229242537292e-18 -1.935039502284857e-20 -0.01120493871436457 -5.52361117057418e-05 1.107648220312933e-06 -1.413462091609402e-09 -3.102372839362798e-11 1.136639552848477e-13 ; }
M_interpFunc2__Xr1_RLB FUNCTION { numer=6; denom=5; coeff=-0.9766733406837279 -0.05206532629981097 -0.001088628323877447 -1.084609104167111e-05 -4.910062212772982e-08 -7.179457073374691e-11 0.04983685263486099 0.001182410550950157 8.888777240348568e-06 6.84475084946585e-08 ; }
M_interpFunc3__Xr2_RLA FUNCTION { numer=11; denom=1; coeff=-0.0003279310706775509 -1.886953181155318e-21 -3.708655021918902e-08 2.436678871554328e-24 -7.64663105590788e-12 -1.411962148690044e-27 -6.727504651170919e-16 2.303114720838081e-31 -2.269943687289299e-20 -1.186389605934684e-35 -1.31226699345563e-24 ; }
M_interpFunc4__Xr2_RLB FUNCTION { numer=4; denom=3; coeff=-0.02499715032969045 0.000686328391618479 -7.733353509625659e-06 3.31605361148897e-08 0.01379832986277666 7.092541494416318e-05 ; }
M_interpFunc5__Xs_RLA FUNCTION { numer=9; denom=9; coeff=-1.278534761985301e-06 7.729917835426426e-08 -5.327266482869784e-09 1.586629276787992e-10 -4.329798648705654e-12 6.681153147349434e-14 -1.014660547484676e-15 8.720185463617624e-18 -7.305178287950985e-20 -0.0136185066611899 0.001092805764827556 -3.312294595095505e-07 3.400266637134824e-07 -6.300666900959196e-09 7.846828695147292e-11 -6.748878279343878e-13 5.942705569169954e-15 ; }
M_interpFunc6__Xs_RLB FUNCTION { numer=6; denom=3; coeff=-0.5880079690538645 -0.02009473418520617 -0.0002642538945452464 -1.368770723145289e-06 4.460045749402738e-10 1.987755369253586e-11 0.004816942116370315 0.0004888977452036488 ; }
M_interpFunc7__d_RLA FUNCTION { numer=7; denom=11; coeff=-0.001508246626150832 -7.766739026294766e-05 -6.41532103425608e-06 -7.900150266426333e-08 -1.126924335810641e-09 1.115179711043105e-13 -3.554936288940667e-13 -0.06854912274322196 0.003521972773048252 9.804359679011875e-06 4.769962695489705e-07 2.089079658108246e-08 3.351806346579726e-10 -2.132247194082161e-13 -6.953054134704356e-15 1.426872884152207e-17 1.845308191299501e-19 ; }
M_interpFunc8__d_RLB FUNCTION { numer=6; denom=5; coeff=-0.7430868973738544 -0.04501492042651048 -0.001126871818464628 -1.437103911036219e-05 -9.233935643934692e-08 -2.37280421188512e-10 0.02633922089086687 0.001706902717979468 5.075323412657009e-06 1.670957160537096e-07 ; }
M_interpFunc9__f2_RLA FUNCTION { numer=11; denom=13; coeff=-3.018843149461905e-05 -3.205861139726081e-06 -2.216268265330307e-07 -1.027767637496779e-08 -3.261655335401849e-10 -7.209129227941619e-12 -1.609466332473558e-13 -4.610615653296057e-15 -1.031247119217511e-16 -1.243054399023358e-18 -6.090627153550448e-21 -0.08177342564413387 0.005404292087555039 9.901442189534309e-05 2.701466745920271e-06 2.8951232813883e-07 7.703903025293523e-09 1.257818093684605e-10 2.78694506936985e-12 4.189631513527366e-14 2.123066908941585e-16 -3.305709114147807e-19 9.670987847339582e-22 ; }
M_interpFunc10__f2_RLB FUNCTION { numer=5; denom=6; coeff=-0.3342260991386776 -0.01635249655589773 -0.0003770637952345393 -2.805245138848484e-06 -2.329313633970433e-08 0.05082298742877954 0.001083903137738948 9.84261428099207e-06 5.636171520458652e-08 5.55753517104387e-11 ; }
M_interpFunc11__f_RLA FUNCTION { numer=9; denom=16; coeff=-8.729719835752885e-06 -8.632548938015279e-07 -4.777985206488007e-08 -1.646539765502365e-09 -4.616992194892855e-11 -1.327126656418475e-12 -3.394527385459784e-14 -5.23208362035311e-16 -3.476628787442091e-18 0.03094379839289099 0.009051555112601651 0.0003563555019983819 9.543548160348957e-06 3.153000664621094e-07 7.852776516835092e-09 1.070295576779143e-10 6.881338040917667e-13 1.428047145123281e-15 6.995744451699541e-18 -1.302692284970881e-19 -3.958281823586496e-22 6.834865559373112e-24 8.787712580829402e-27 -1.496198902074242e-28 ; }
M_interpFunc12__f_RLB FUNCTION { numer=6; denom=5; coeff=-0.05419584782087128 0.004889606599427181 -0.0001909355000174025 3.734773205467139e-06 -3.51578858375799e-08 1.258939720254668e-10 0.04821845364006313 0.001375893229658492 9.140757496035736e-06 1.016825533514049e-07 ; }
M_interpFunc13__h_RLA FUNCTION { numer=18; denom=14; coeff=-0.004274372096149744 -0.0008585018228428926 -7.922827612133398e-05 -4.457803101978658e-06 -1.711169026187101e-07 -4.75103221899629e-09 -9.867001472772391e-11 -1.561978923957316e-12 -1.899202741506426e-14 -1.766850396222619e-16 -1.233595061209387e-18 -6.175323860693562e-21 -1.996727642411331e-23 -3.040611101159791e-26 1.350370539468061e-29 6.432312686890238e-34 -3.216869325250681e-34 8.974186431861424e-37 0.1759645279168838 0.01465861892607143 0.0007731426387119919 2.885536215919781e-05 7.990164882732646e-07 1.670702030029492e-08 2.653755100213876e-10 3.215823027754888e-12 2.98197552766131e-14 2.091544617479964e-16 1.052393833198744e-18 3.342481185181024e-21 4.929380464537494e-24 ; }
M_interpFunc14__h_RLB FUNCTION { numer=8; denom=5; coeff=3.800626809234725e-07 8.581219212511173e-07 -1.065641933533206e-08 -1.503301258345549e-09 2.276231372763749e-11 5.204871492514412e-13 -1.185276435018253e-14 5.914586754361125e-17 0.04436207027989952 0.0007507903046212455 5.750399575316655e-06 1.699005378784748e-08 ; }
M_interpFunc15__j_RLA FUNCTION { numer=17; denom=14; coeff=-0.0005763347943174887 -0.0001177683181248054 -1.099906928621777e-05 -6.253757353909718e-07 -2.429598764823785e-08 -6.854271228266933e-10 -1.45438559894818e-11 -2.366063039440857e-13 -2.969391487116654e-15 -2.850734785445407e-17 -2.025446325172896e-19 -9.552496481750107e-22 -1.44784812007946e-24 2.091366273699364e-26 2.158135267795286e-28 9.949428662313174e-31 1.967623444710604e-33 0.1434412820754331 0.008683413122997133 0.0002854227446018134 5.259369980698662e-06 4.401750723421954e-08 -1.450370383050741e-10 -5.81294093434697e-12 -2.215774387870242e-14 3.300989879283735e-16 2.223377797534463e-18 -1.206938201350936e-20 -7.011146406565885e-23 3.81778539202762e-25 ; }
M_interpFunc16__j_RLB FUNCTION { numer=8; denom=5; coeff=3.800626809234725e-07 8.581219212511173e-07 -1.065641933533206e-08 -1.503301258345549e-09 2.276231372763749e-11 5.204871492514412e-13 -1.185276435018253e-14 5.914586754361125e-17 0.04436207027989952 0.0007507903046212455 5.750399575316655e-06 1.699005378784748e-08 ; }
M_interpFunc17__m_RLA FUNCTION { numer=11; denom=13; coeff=-0.01760259440813951 -0.002442307153194826 -0.0001586249555114142 -6.325520119909603e-06 -1.706279598001057e-07 -3.220545633293828e-09 -4.250143314546868e-11 -3.81833586167646e-13 -2.2057565109556e-15 -7.304377551213405e-18 -1.037445892305318e-20 0.1362618729860797 0.008697839953913759 0.000339168454972911 8.893145278295859e-06 1.614821642493764e-07 2.009293127733268e-09 1.634300506002839e-11 7.735440514376824e-14 1.391222564027269e-16 -3.035960496452515e-19 -9.514304553376028e-22 1.754390513939059e-24 ; }
M_interpFunc18__m_RLB FUNCTION { numer=5; denom=5; coeff=-0.9963008765016075 -0.04398098322838684 -0.0007312181035471139 -5.423199796455669e-06 -1.513022905240932e-08 0.04371848449484093 0.0007385703602161073 5.334018047305667e-06 1.551565313237431e-08 ; }
M_interpFunc19__r_RLA FUNCTION { numer=7; denom=7; coeff=-0.0002125165066216913 -4.143479667875527e-06 -1.078939954599874e-07 -1.421480474474739e-09 -2.074033419467694e-11 -1.75159637618483e-13 -1.06630126665929e-15 -0.0173684215280334 0.0001479125295592711 3.208334793483115e-06 2.858361648972412e-09 8.582894056458255e-11 1.326202534151792e-12 ; }
M_interpFunc20__r_RLB FUNCTION { numer=7; denom=5; coeff=-0.03462089674330038 -0.00349790253568844 -0.0001529648629668183 -3.526660235872793e-06 -4.405269283614466e-08 -2.801469427573024e-10 -7.079849598236466e-13 -0.06193199817949042 0.00194295113079446 -2.062369137520492e-05 1.974048922735071e-07 ; }
M_interpFunc21__s_RLA FUNCTION { numer=12; denom=12; coeff=-0.0001240924534850863 -4.907376692490301e-06 -4.474724307898783e-08 -8.184595339763372e-10 -2.033609057273269e-10 -1.020721306564198e-11 -3.042637757555778e-13 -7.372162583070011e-15 -1.420373253407439e-16 -1.794375813042591e-18 -1.240432803984576e-20 -3.415038327393999e-23 0.03211738196980414 0.0005651398514373975 -4.472626004784566e-05 1.041378846556796e-06 4.179864182053855e-08 7.33016638501259e-10 2.164431886941443e-11 4.471922144012605e-13 5.3122248892988e-15 3.667482645919935e-17 1.054009857965247e-19 ; }
M_interpFunc22__s_RLB FUNCTION { numer=7; denom=5; coeff=-0.01789562970732256 0.002417858493180462 -0.0001354469258804975 3.771036281338229e-06 -5.445386361253197e-08 3.896149522815568e-10 -1.090927869556893e-12 0.07142159781717333 0.002329819748939688 2.779434832352999e-05 2.645163683258629e-07 ; }
M_interpFunc23_exp_gamma_VFRT FUNCTION { numer=6; denom=1; coeff=1.000159767482317 0.01310298154902786 8.549569770553761e-05 3.738385671426183e-07 1.326803990607786e-09 3.435833900584067e-12 ; }
M_interpFunc24_exp_gamma_m1_VFRT FUNCTION { numer=3; denom=5; coeff=0.9999347156003997 -0.008222920678954044 1.995262950329589e-05 0.01610925220463791 0.0001157218643208404 4.481834746568406e-07 7.933003008362428e-10 ; }
M_interpFunc25_i_CalTerm3 FUNCTION { numer=7; denom=3; coeff=321192.590083431 -11058.97334744292 158.3592294482738 -1.124152269246383 0.003299677802883148 2.400740851360956e-06 -2.467664170785679e-08 -0.003867438878601671 0.0001270829193569464 ; }
M_interpFunc26_i_CalTerm4 FUNCTION { numer=4; denom=7; coeff=104480.846195948 2302.019006378678 18.23593247308357 0.05164692279685336 -0.0222741542108515 0.0003994863887847324 -4.386132499416209e-06 3.228376015208203e-08 -1.439940672237026e-10 2.92569675332555e-13 ; }
M_interpFunc27_i_NaK_term FUNCTION { numer=5; denom=3; coeff=1.981719834772234 0.02649635322302648 0.0001204063932015486 1.286161285195025e-07 -2.923254309171041e-10 0.01182863273441871 6.226083056535352e-05 ; }
M_interpFunc28_i_p_K_term FUNCTION { numer=7; denom=12; coeff=0.01505892947569871 0.0009014929478362467 2.35006712623932e-05 3.402090225863921e-07 2.870355124601152e-09 1.330541949077326e-11 2.63151785163872e-14 -0.1048428471409596 0.005471942327966154 -0.000177639608947056 4.096779149175464e-06 -6.946393045097052e-08 8.840029117557671e-10 -8.380424768523269e-12 5.758154463329654e-14 -2.709089570303815e-16 7.794547464864762e-19 -1.031970663205818e-21 ; }
M_interpFunc29_inward_rectifier_potassium_current_i_Kitot FUNCTION { numer=9; denom=14; coeff=-0.001711619143636781 0.3261204795219927 -0.0136099890016561 0.007714789213957467 -0.0002126523253181915 1.770795983687534e-05 -3.481416706652583e-07 2.575596246208528e-09 -6.701506320529826e-12 0.205786429138607 0.02144350856025031 0.001065816269837857 4.381818246888003e-05 1.090822784524997e-06 3.059358415204762e-08 7.308293916093376e-10 1.457147089284584e-11 2.115356115903064e-13 2.093962299654027e-15 1.329427103901446e-17 4.870640159547573e-20 7.826125245585299e-23 ; }



